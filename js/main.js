"use strict";var app={};app.partial={};var debug=/localhost[:]9000|nelson119.github.io/.test(location.href);$(function(){$.each(app.partial,function(t,e){e()}),app.imageReload.callback=function(){$("html").addClass("loading-done")},app.imageReload.init()});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};app.utility=new function(){$.fn.hasAttr=function(t){var e=$(this).attr(t);return"undefined"!==("undefined"==typeof e?"undefined":_typeof(e))&&e!==!1},this.share={facebook:function(t,e){t=encodeURIComponent(t||location.href+"?utm_source=facebook&utm_medium=fbshare_m&utm_campaign=camp"),e=encodeURIComponent(e||document.title),window.open("https://www.facebook.com/sharer.php?u="+t+"&amp;t="+e)},googleplus:function(t){t=encodeURIComponent(t||location.href+"?utm_source=g+&utm_medium=googleplus_m&utm_campaign=camp"),window.open("https://plus.google.com/share?url="+t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},email:function(t,e){t=encodeURIComponent(t||location.href+"?utm_source=email&utm_medium=email_m&utm_campaign=camp"),e=encodeURIComponent(e||document.title);var a=encodeURIComponent(""+t+" #"+e);window.open("https://mail.google.com/mail/?view=cm&fs=1&to=&su=與你分享:"+e+"&body="+a+"&bcc=")}},this.getParam=function(t){var e=new RegExp("^.*[?&]"+t+"[=]([^&]+).*$","i");if(!e.test(location.search))return null;var a=location.search.replace(e,"$1");return decodeURIComponent(a)}},app.partial.preload=function(){function t(t){function e(t){n[t]=!0;var e=!0;$.each(n,function(t,a){e=a&&e}),e&&a()}function a(){"function"==typeof app.imageReload.callback&&app.imageReload.callback()}var n={},o=[],i=$("img[data-src]:visible, figure[data-src]:visible").not("[src],[style]");i.each(function(t,e){$(e).attr("data-src")&&(n[$(e).attr("data-src")]=!1,o.push(e))}),$.each(n,function(t,a){if(/\.svg$/.test(t))$.get(t,function(a){$(o).filter(function(){return t==$(this).attr("data-src")}).each(function(t,e){"img"===e.tagName.toLowerCase()?($("svg",a).clone().insertAfter(e),$(e).remove()):$(e).removeAttr("data-src").html($("svg",a).clone())});e(t)});else{var n=new Image;n.onload=function(){$(o).filter(function(){return t==$(this).attr("data-src")}).each(function(t,e){"img"===e.tagName.toLowerCase()?$(e).attr("src",$(e).attr("data-src")):$(e).css("background-image","url("+$(e).attr("data-src")+")")});e(t)},n.src=t}})}app.dementions={mobile:!1,desktop:!1},app.imageReload={init:function(){$(window).on("resize",function(){$("img[data-src]:visible, figure[data-src]:visible").not("[src],[style]").length&&$(window).width()<=768?t(function(){app.dementions.mobile=!0}):$("img[data-src]:visible, figure[data-src]:visible").not("[src],[style]").length&&$(window).width()>768?t(function(){app.dementions.desktop=!0}):app.imageReload.callback()}).trigger("resize")},refresh:function(){$(window).trigger("resize")},callback:function(){}}},app.partial.spa=function(){function t(t,a,n,o,r){r=r||!1,i.trigger("page:preupdate"),r||location.pathname===t||$("html").removeClass("loading-done"),$.get(t,function(o){var c=c,l="";$(o).each(function(t,e){"og:title"===$(e).attr("property")&&(c=$(e).attr("content")),"container"===$(e).attr("role")&&(l=$(e).find("[role=main]"))}),r||e({uri:t,name:a,menu:n,title:c},"update content"+t),i.html(l),i.trigger("page:update:"+a,n),i.trigger("page:update",n),app.imageReload.init()})}function e(t,e){t.title=t.title||r,document.title=t.title,history.pushState(t,t.title,t.uri)}var a=/localhost[:]9000|github.io/.test(location.href),n=/nelson.works\/obcart/.test(location.href),o=n?"/obcart/":"/",i=$("#container"),r=document.title;if(app.spa={container:i,title:r,rootPath:o,github:n,debug:a},$(window).on("popstate",function(e){var a=e.originalEvent.state;return null===a&&(location.href=o),document.title=a.title,t(a.uri,a.name,a.menu,function(){},!0),!0}),$("a[data-href]").on("click",function(e){$(this).addClass("active").siblings().removeClass("active");var a=$(this).attr("data-href"),n=$(this).attr("data-name"),o=null;t(a,n,o,function(){console.log(n)})}),app.utility.getParam("path")){var c=decodeURIComponent(app.utility.getParam("path"));$("a[data-href="+c+"]").trigger("click")}i.on("page:update",function(t,e){}),i.trigger("page:update","home")},app.partial.i18n=function(){$(".i18n .to").on("click",function(){return $(this).addClass("active").siblings().removeClass("active"),$("html").attr("lang")!==$(this).attr("data-lang")&&($("html").removeClass("loading-done"),$("html").attr("lang",$(this).attr("data-lang")),void app.imageReload.refresh())});var t=$("html").attr("lang");t&&$(".i18n .to[data-lang="+t+"]").trigger("click")},app.partial.ga=function(){};